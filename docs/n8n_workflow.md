 # å¾®ä¿¡å…¬ä¼—å·çˆ¬è™« n8n å·¥ä½œæµè¯´æ˜æ–‡æ¡£

## 1. æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†æè¿°äº†å¾®ä¿¡å…¬ä¼—å·çˆ¬è™«é¡¹ç›®ä¸­ä¸ n8n å·¥ä½œæµé›†æˆçš„ç›¸å…³å†…å®¹ï¼Œä¸»è¦ç”¨äºè‡ªåŠ¨åŒ–å¾®ä¿¡å…¬ä¼—å·ç™»å½•æµç¨‹ï¼Œè§£å†³ä¼šè¯è¿‡æœŸé—®é¢˜ï¼Œç¡®ä¿çˆ¬è™«èƒ½å¤ŸæŒç»­ç¨³å®šè¿è¡Œã€‚é€šè¿‡ n8n è¿™ä¸€å¼ºå¤§çš„å·¥ä½œæµè‡ªåŠ¨åŒ–å¹³å°ï¼Œæˆ‘ä»¬å®ç°äº†ä»å¾®ä¿¡ç™»å½•åˆ°æ•°æ®å¤„ç†çš„å…¨æµç¨‹è‡ªåŠ¨åŒ–ï¼Œå¤§å¹…æé«˜äº†ç³»ç»Ÿçš„å¯é æ€§å’Œè¿è¡Œæ•ˆç‡ã€‚

## 2. ç°çŠ¶

ç›®å‰ï¼Œå¾®ä¿¡å…¬ä¼—å·çˆ¬è™«ç³»ç»Ÿå·²ç»å°†å¾®ä¿¡ç™»å½•æµç¨‹æ¥å…¥åˆ° n8n å·¥ä½œæµä¸­ï¼Œå®ç°äº†ä»¥ä¸‹åŠŸèƒ½ï¼š

1. è‡ªåŠ¨æ£€æµ‹ä¼šè¯å¤±æ•ˆ
2. è§¦å‘ç™»å½•æµç¨‹
3. è·å–æ–°çš„ä¼šè¯å‡­è¯
4. æ›´æ–°ç³»ç»Ÿä¸­çš„ä¼šè¯ä¿¡æ¯
5. çˆ¬å–å†…å®¹è‡ªåŠ¨å¤„ç†ä¸å­˜å‚¨
6. æ•°æ®æ¨é€åˆ°å¤šç§ç»ˆç«¯

## 3. æŠ€æœ¯æ¶æ„

### 3.1 ç»„ä»¶å…³ç³»

```
+----------------+         +----------------+         +----------------+
|                |         |                |         |                |
|  FastAPI åç«¯  | <-----> |  n8n å·¥ä½œæµ    | <-----> |  å¾®ä¿¡å…¬ä¼—å¹³å°  |
|                |         |                |         |                |
+----------------+         +----------------+         +----------------+
        ^                                                     ^
        |                                                     |
        v                                                     v
+----------------+                                   +----------------+
|                |                                   |                |
|  é˜¿é‡Œäº‘ OSS    |                                   |  æ•°æ®æ¶ˆè´¹ç«¯    |
|                |                                   |                |
+----------------+                                   +----------------+
```

### 3.2 å…³é”®æŠ€æœ¯ç‚¹

- **FastAPI**: æä¾› API æ¥å£ï¼Œå¤„ç†å¾®ä¿¡å…¬ä¼—å·æ•°æ®çˆ¬å–è¯·æ±‚
- **n8n**: è‡ªåŠ¨åŒ–å·¥ä½œæµå¹³å°ï¼Œå¤„ç†å¾®ä¿¡ç™»å½•æµç¨‹å’Œæ•°æ®å¤„ç†
- **Webhook**: ç”¨äº FastAPI ä¸ n8n ä¹‹é—´çš„é€šä¿¡
- **å¼‚å¸¸å¤„ç†æœºåˆ¶**: æ£€æµ‹ä¼šè¯å¤±æ•ˆå¹¶è§¦å‘ n8n å·¥ä½œæµ
- **é˜¿é‡Œäº‘ OSS**: ç”¨äºå­˜å‚¨çˆ¬å–çš„å†…å®¹å’Œå¤„ç†åçš„æ•°æ®
- **æ¨é€æœåŠ¡**: æ”¯æŒå¤šç§æ¨é€æ–¹å¼ï¼ŒåŒ…æ‹¬å¾®ä¿¡ã€Telegramç­‰

## 4. å·¥ä½œæµç¨‹

### 4.1 ä¼šè¯å¤±æ•ˆæ£€æµ‹

å½“ç³»ç»Ÿæ£€æµ‹åˆ°å¾®ä¿¡ API è¿”å› `invalid session` é”™è¯¯æ—¶ï¼Œä¼šè§¦å‘ n8n å·¥ä½œæµï¼š

```python
# app/middleware/exception_handlers.py
if 'invalid session' in error_msg:
    # æ£€æŸ¥é”æ˜¯å¦å·²å­˜åœ¨
    global n8n_workflow_lock
    # è·å–å½“å‰æ—¶é—´
    current_time = datetime.now()
    
    # å¦‚æœé”å­˜åœ¨ï¼Œä½†è¶…è¿‡æœ€å¤§æŒç»­æ—¶é—´ï¼Œåˆ™é‡Šæ”¾é”
    if (n8n_workflow_lock["is_running"] and n8n_workflow_lock["started_at"] 
        and (current_time - n8n_workflow_lock["started_at"]) > timedelta(seconds=n8n_workflow_lock["max_duration"])):
        # é‡Šæ”¾é”
        n8n_workflow_lock["is_running"] = False
        n8n_workflow_lock["started_at"] = None
        
    # å¦‚æœå·¥ä½œæµæœªè¿è¡Œï¼Œåˆ™è®¾ç½®é”å¹¶æ‰§è¡Œ
    if not n8n_workflow_lock["is_running"]:
        try:
            # è®¾ç½®é”
            n8n_workflow_lock["is_running"] = True
            n8n_workflow_lock["started_at"] = current_time
            # è°ƒç”¨n8nç™»å½•å·¥ä½œæµ
            n8n_webhook_url = settings.N8N_WEBHOOK_URL
            async with httpx.AsyncClient() as client:
                response = await client.get(n8n_webhook_url)
        finally:
            # é‡Šæ”¾é”
            n8n_workflow_lock["is_running"] = False
            n8n_workflow_lock["started_at"] = None
```

### 4.2 å¾®ä¿¡ç™»å½•æµç¨‹

å¾®ä¿¡ç™»å½•æµç¨‹åŒ…å«ä»¥ä¸‹æ­¥éª¤ï¼Œè¿™äº›æ­¥éª¤å·²ç»åœ¨ n8n å·¥ä½œæµä¸­å®ç°ï¼š

1. **é¢„ç™»å½•**ï¼šè·å–å¿½ç•¥å¯†ç åˆ—è¡¨
   ```
   POST /cgi-bin/bizlogin
   Host: https://mp.weixin.qq.com
   action=prelogin
   ```

2. **å¼€å§‹ç™»å½•**ï¼šè·å–äºŒç»´ç 
   ```
   POST /cgi-bin/bizlogin?action=startlogin
   Host: https://mp.weixin.qq.com
   
   userlang=zh_CN
   redirect_url=
   login_type=3
   sessionid=sessionid
   ```

3. **ä¸ŠæŠ¥è®¾å¤‡ä¿¡æ¯**ï¼š
   ```
   POST /cgi-bin/webreport
   Host: https://mp.weixin.qq.com
   reportJson={"devicetype":1,"newsessionid":"172059629456827","optype":1,"page_state":3,"log_id":19015}
   ```

4. **è·å–ç™»å½•äºŒç»´ç **ï¼š
   ```
   GET /cgi-bin/scanloginqrcode?action=getqrcode&random={random_num}
   Host: https://mp.weixin.qq.com
   ```

5. **è·å–äºŒç»´ç çŠ¶æ€**ï¼š
   ```
   GET /cgi-bin/scanloginqrcode?action=ask&fingerprint=9b1ea719e1ba482a27d45364d3c7f877&token=&lang=zh_CN&f=json
   Host: https://mp.weixin.qq.com
   ```

6. **è·å–ç™»å½•ä¿¡æ¯**ï¼š
   ```
   POST /cgi-bin/bizlogin?action=login
   Host: https://mp.weixin.qq.com
   ```

7. **éªŒè¯ç”¨æˆ·ä¿¡æ¯**ï¼š
   ```
   GET /cgi-bin/home?action=get_finder_live_info&fingerprint=77d0c4a6149482d13b8a9b1dea06ad99&token={token}&lang=zh_CN&f=json&ajax=1
   Host: https://mp.weixin.qq.com
   ```

8. **è·å–ä¸ªäººç™»å½•ä¿¡æ¯**ï¼š
   ```
   GET {redirect_url}
   Host: https://mp.weixin.qq.com
   ```

### 4.3 æ•°æ®å¤„ç†ä¸å­˜å‚¨

ç™»å½•æˆåŠŸåï¼Œç³»ç»Ÿä¼šæ‰§è¡Œä»¥ä¸‹æ•°æ®å¤„ç†æµç¨‹ï¼š

1. **æ•°æ®çˆ¬å–**ï¼šé€šè¿‡å·²è®¤è¯çš„ä¼šè¯è·å–å¾®ä¿¡å…¬ä¼—å·æ–‡ç« å†…å®¹
2. **æ•°æ®æ¸…æ´—**ï¼šå¤„ç†HTMLå†…å®¹ï¼Œæ›¿æ¢èµ„æºé“¾æ¥ï¼Œæå–å…³é”®ä¿¡æ¯
3. **æœ¬åœ°å­˜å‚¨**ï¼šå°†å¤„ç†åçš„å†…å®¹ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ
4. **äº‘ç«¯ä¸Šä¼ **ï¼šå°†æ–‡ä»¶ä¸Šä¼ åˆ°é˜¿é‡Œäº‘OSSå­˜å‚¨ï¼Œç¡®ä¿å†…å®¹çš„æŒä¹…æ€§å’Œå¯è®¿é—®æ€§

```python
# å­˜å‚¨htmlåˆ°æœ¬åœ°
local_file_path = save_html_to_local(html_content, wx_public_name, wx_public_id=wx_public_id)
# ä¸Šä¼ åˆ°é˜¿é‡Œäº‘
oss_file_path = upload_to_aliyun(local_file_path)
```

## 5. n8n å·¥ä½œæµè®¾è®¡ä¸å®ç°

### 5.1 å·¥ä½œæµæ¦‚è§ˆ

n8n å·¥ä½œæµè®¾è®¡åŒ…å«ä»¥ä¸‹ä¸»è¦èŠ‚ç‚¹ï¼š

1. **Webhook è§¦å‘å™¨**ï¼šæ¥æ”¶æ¥è‡ª FastAPI çš„è¯·æ±‚
2. **HTTP è¯·æ±‚èŠ‚ç‚¹**ï¼šæ‰§è¡Œå¾®ä¿¡ç™»å½•æµç¨‹çš„å„ä¸ªæ­¥éª¤
3. **ç­‰å¾…èŠ‚ç‚¹**ï¼šç­‰å¾…ç”¨æˆ·æ‰«æäºŒç»´ç 
4. **æ¡ä»¶èŠ‚ç‚¹**ï¼šæ£€æŸ¥ç™»å½•çŠ¶æ€
5. **å‡½æ•°èŠ‚ç‚¹**ï¼šå¤„ç†ç™»å½•å“åº”å’Œä¼šè¯ä¿¡æ¯
6. **HTTP å“åº”èŠ‚ç‚¹**ï¼šå°†ç™»å½•ç»“æœè¿”å›ç»™ FastAPI

### 5.2 å®é™…åº”ç”¨æ¡ˆä¾‹

#### 5.2.1 å¤©æ°”ä¿¡æ¯æ¨é€æ¡ˆä¾‹

åˆ©ç”¨ n8n å·¥ä½œæµï¼Œæˆ‘ä»¬å¯ä»¥å®ç°å¤©æ°”ä¿¡æ¯çš„è‡ªåŠ¨è·å–å’Œæ¨é€ï¼š

1. **æ­¥éª¤ä¸€**ï¼šè¿›å…¥ n8n é¡µé¢ï¼Œç‚¹å‡» Add Workflow
2. **æ­¥éª¤äºŒ**ï¼šæ·»åŠ å®šæ—¶è§¦å‘å™¨ï¼Œè®¾ç½®æ¯å¤©æ—©ä¸Š9ç‚¹è§¦å‘
3. **æ­¥éª¤ä¸‰**ï¼šè®¾ç½®å·¥ä½œæµæ—¶åŒºä¸ºåŒ—äº¬æ—¶é—´ (+08:00)
4. **æ­¥éª¤å››**ï¼šæ·»åŠ  HTTP è¯·æ±‚èŠ‚ç‚¹ï¼Œè·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯
   ```
   URL: http://t.weather.itboy.net/api/weather/city/101210101
   ```
   å…¶ä¸­ 101210101 ä¸ºåŸå¸‚ç¼–ç ï¼ˆæ­å·ï¼‰
5. **æ­¥éª¤äº”**ï¼šæ·»åŠ  JavaScript èŠ‚ç‚¹å¤„ç†å¤©æ°”æ•°æ®

```javascript
// å¤„ç†å¤©æ°”æ•°æ®çš„JavaScriptä»£ç ç¤ºä¾‹
shidu = items[0].json.data.shidu;
pm25 = items[0].json.data.pm25;
pm10 = items[0].json.data.pm10;
quality = items[0].json.data.quality;
wendu = items[0].json.data.wendu;
ganmao = items[0].json.data.ganmao;
high = items[0].json.data.forecast[0].high;
low = items[0].json.data.forecast[0].low;
fx = items[0].json.data.forecast[0].fx;
fl = items[0].json.data.forecast[0].fl;
type = items[0].json.data.forecast[0].type;
ymd = items[0].json.data.forecast[0].ymd;
week = items[0].json.data.forecast[0].week;

var yubao = `æ­å·ä»Šæ—¥å¤©æ°”é¢„æŠ¥ï¼š\n` +
            `ğŸ“… æ—¥æœŸ: ${ymd} (${week})\n` +
            `ğŸŒ¤ å¤©æ°”: ${type}\n` +
            `ğŸŒ¡ æ¸©åº¦: ${low} ~ ${high}\n` +
            `ğŸ é£åŠ›: ${fx} ${fl}\n` +
            `ğŸ“Š ç©ºæ°”è´¨é‡: ${quality} (PM2.5: ${pm25} | PM10: ${pm10})\n` +
            `ğŸ’§ æ¹¿åº¦: ${shidu}\n` +
            `âš ï¸ æç¤º: ${ganmao}`;

// ä¸­æ–‡å†™å›åˆ°åˆ° json ä¸­
items[0].json.yubao = yubao;
// è½¬ä¹‰æ¢è¡Œç¬¦,ä¸ºäº†åœ¨åç»­çš„èŠ‚ç‚¹ä¸­æ­£ç¡®è§£ææ¢è¡Œ
items[0].json.yubao_escaped = yubao.replace(/\n/g, "\\n");  

return items;
```

6. **æ­¥éª¤å…­**ï¼šæ·»åŠ  HTTP è¯·æ±‚èŠ‚ç‚¹ï¼Œå°†å¤„ç†åçš„å¤©æ°”ä¿¡æ¯æ¨é€åˆ°æŒ‡å®šå¹³å°

#### 5.2.2 ç¤¾äº¤åª’ä½“å†…å®¹ç”Ÿæˆæ¡ˆä¾‹

åˆ©ç”¨ n8n ä¸ AI é›†æˆï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ä» Telegram æ¶ˆæ¯è§¦å‘çš„ç¤¾äº¤åª’ä½“å†…å®¹è‡ªåŠ¨ç”Ÿæˆï¼š

1. **æ¥æ”¶æ¶ˆæ¯**ï¼šé€šè¿‡ Telegram æ¥æ”¶ç”¨æˆ·çš„ä¸»é¢˜è¯·æ±‚ï¼ˆæ–‡æœ¬æˆ–è¯­éŸ³ï¼‰
2. **å¤„ç†è¯­éŸ³**ï¼šå¦‚æœæ˜¯è¯­éŸ³æ¶ˆæ¯ï¼Œä½¿ç”¨ OpenAI Whisper API è½¬æ¢ä¸ºæ–‡æœ¬
3. **AI å¤„ç†**ï¼šä½¿ç”¨ AI Agentï¼ˆOpenAI + SerpAPIï¼‰è¿›è¡Œç ”ç©¶å’Œå†…å®¹ç”Ÿæˆ
4. **å†…å®¹è¾“å‡º**ï¼šç”Ÿæˆç¤¾äº¤åª’ä½“å†…å®¹å’Œå›¾åƒæç¤ºï¼Œå¯ç”¨äºåç»­å‘å¸ƒ

#### 5.2.3 Telegram æ¶ˆæ¯ä»£ç†æ¡ˆä¾‹

åˆ›å»ºä¸€ä¸ªæ™ºèƒ½ Telegram æœºå™¨äººï¼Œå¤„ç†å¤šç§ç±»å‹çš„æ¶ˆæ¯å¹¶æä¾›è‡ªåŠ¨å“åº”ï¼š

1. **æ¶ˆæ¯æ¥æ”¶**ï¼šæ¥æ”¶æ–‡æœ¬ã€è¯­éŸ³å’Œå›¾åƒæ¶ˆæ¯
2. **æ¶ˆæ¯åˆ†ç±»**ï¼šæ ¹æ®æ¶ˆæ¯ç±»å‹è¿›è¡Œåˆ†ç±»å¤„ç†
3. **AI å¤„ç†**ï¼šä½¿ç”¨ OpenAI è¿›è¡Œæ¶ˆæ¯ç†è§£å’Œå“åº”ç”Ÿæˆ
4. **å“åº”å‘é€**ï¼šå°†ç”Ÿæˆçš„å“åº”å‘é€å› Telegram

## 6. é…ç½®è¯´æ˜

### 6.1 n8n Webhook é…ç½®

åœ¨é¡¹ç›®çš„ç¯å¢ƒé…ç½®æ–‡ä»¶ä¸­è®¾ç½® n8n webhook URLï¼š

```
# .env æˆ– .env.development ç­‰
N8N_WEBHOOK_URL=https://n8n.hokage-yeah.online/webhook/wx-login
```

### 6.2 é”æœºåˆ¶é…ç½®

ä¸ºé˜²æ­¢é‡å¤è§¦å‘ n8n å·¥ä½œæµï¼Œç³»ç»Ÿå®ç°äº†ä¸€ä¸ªç®€å•çš„å†…å­˜é”æœºåˆ¶ï¼š

```python
# åˆ›å»ºä¸€ä¸ªç®€å•çš„å†…å­˜é”ï¼Œç”¨äºé˜²æ­¢é‡å¤è°ƒç”¨n8n
n8n_workflow_lock = {
    "is_running": False,
    "started_at": None,
    "max_duration": 300  # é”å®šæœ€é•¿æ—¶é—´ï¼Œå•ä½ç§’ï¼Œé˜²æ­¢é”æ­»
}
```

### 6.3 é˜¿é‡Œäº‘ OSS é…ç½®

ä¸ºè§£å†³æ–‡ä»¶ä¸Šä¼ è¿‡ç¨‹ä¸­çš„ CRC æ ¡éªŒä¸ä¸€è‡´é—®é¢˜ï¼Œæˆ‘ä»¬å¯¹ä¸Šä¼ ä»£ç è¿›è¡Œäº†ä¼˜åŒ–ï¼š

```python
def upload_to_aliyun(local_file_path: str):
    # è·å–æ–‡ä»¶å
    file_name = os.path.basename(local_file_path)
    # è·å–æ–‡ä»¶å†…å®¹
    file_content = open(local_file_path, 'r', encoding='utf-8').read()

    # å®šä¹‰è¦ä¸Šä¼ çš„æ•°æ®å†…å®¹
    data = file_content.encode('utf-8')  # ç¡®ä¿å†…å®¹ä½¿ç”¨ UTF-8 ç¼–ç 
    key = f"wx_public/{file_name}"

    try:
        # æ‰§è¡Œä¸Šä¼ å¯¹è±¡çš„è¯·æ±‚
        result = client.put_object(oss.PutObjectRequest(
            bucket=bucket_name,
            key=key,
            body=data,
        ))
        # è¿”å›æ–‡ä»¶è·¯å¾„
        oss_file_path = f'https://{bucket_name}.{endpoint}/{key}'
        return oss_file_path
    except Exception as e:
        print(f"Upload error: {str(e)}")
        return None
```

## 7. æ¨é€æ¶ˆæ¯æ–¹æ¡ˆ

ä¸ºäº†å®ç°çˆ¬å–å†…å®¹çš„æ¨é€ï¼Œæˆ‘ä»¬æä¾›äº†å¤šç§æ¨é€æ–¹æ¡ˆï¼š

### 7.1 å¾®ä¿¡æ¨é€

é€šè¿‡ WxPusher æœåŠ¡å®ç°å¾®ä¿¡æ¶ˆæ¯æ¨é€ï¼š

```python
def wxPusher_send_message_post(message):
    import requests
    import json
    app_token = 'xxx'
    UID = 'xxx'

    data = {
        "appToken": app_token,
        "content": message,
        "summary": message,
        "contentType": 1,
        "topicIds": [123],
        "uids": [UID],
        "url": "https://wxpusher.zjiecode.com",
        "verifyPay": False
    }
    json_data = json.dumps(data)
    url = "https://wxpusher.zjiecode.com/api/send/message"
    headers = {'Content-Type': "application/json"}
    request = requests.post(url, data=json_data, headers=headers)
    return request
```

### 7.2 å…¶ä»–æ¨é€æ–¹æ¡ˆ

é™¤äº† WxPusherï¼Œè¿˜æœ‰å¤šç§å¼€æºæ¨é€æ–¹æ¡ˆå¯ä¾›é€‰æ‹©ï¼š

1. **PushDeer**ï¼šå¤šç«¯å®æ—¶æ¶ˆæ¯æ¨é€æœåŠ¡æ–¹æ¡ˆ
2. **ntfy**ï¼šè·¨å¹³å°æ¶ˆæ¯æ¨é€æœåŠ¡ï¼Œéƒ¨ç½²ç®€å•
3. **Bark**ï¼šåŸºäºAPNså°†æ¶ˆæ¯ç›´è¾¾iPhoneé”å±
4. **Gotify**ï¼šå¿«é€Ÿæ­å»ºæœ¬åœ°å®æ—¶æ¶ˆæ¯æ¨é€å¹³å°

## 8. æœªæ¥è®¡åˆ’

1. **è‡ªåŠ¨åŒ–æå‡**ï¼š
   - å®ç°å®Œå…¨æ— äººå€¼å®ˆçš„ç™»å½•æµç¨‹
   - æ·»åŠ ç™»å½•å¤±è´¥é‡è¯•æœºåˆ¶
   - ä¼˜åŒ–äºŒç»´ç è¯†åˆ«å’Œè‡ªåŠ¨æ‰«ç åŠŸèƒ½

2. **ç›‘æ§ä¸å‘Šè­¦**ï¼š
   - æ·»åŠ ç™»å½•çŠ¶æ€ç›‘æ§
   - å®ç°ç™»å½•å¤±è´¥å‘Šè­¦é€šçŸ¥
   - å»ºç«‹ç³»ç»Ÿè¿è¡ŒçŠ¶æ€ä»ªè¡¨ç›˜

3. **å®‰å…¨æ€§å¢å¼º**ï¼š
   - åŠ å¼ºå‡­è¯ç®¡ç†
   - å®ç°å¤šè´¦å·è½®æ¢æœºåˆ¶
   - å¢åŠ è¯·æ±‚é¢‘ç‡é™åˆ¶å’ŒIPè½®æ¢

4. **æ‰©å±•åŠŸèƒ½**ï¼š
   - å°†æ›´å¤šçˆ¬è™«ä»»åŠ¡æ•´åˆåˆ° n8n å·¥ä½œæµ
   - å®ç°å®šæ—¶çˆ¬å–ç‰¹å®šå…¬ä¼—å·å†…å®¹
   - æ·»åŠ å†…å®¹åˆ†æå’Œæ‘˜è¦ç”ŸæˆåŠŸèƒ½

5. **AI é›†æˆ**ï¼š
   - åˆ©ç”¨ AI è¿›è¡Œå†…å®¹åˆ†ç±»å’Œæ ‡ç­¾æå–
   - è‡ªåŠ¨ç”Ÿæˆå†…å®¹æ‘˜è¦
   - å®ç°æ™ºèƒ½æ¨èç³»ç»Ÿ

## 9. å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

1. **n8n å·¥ä½œæµè§¦å‘å¤±è´¥**
   - æ£€æŸ¥ webhook URL æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤ n8n æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
   - æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œé˜²ç«å¢™è®¾ç½®

2. **ç™»å½•æµç¨‹ä¸­æ–­**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - ç¡®è®¤å¾®ä¿¡å…¬ä¼—å¹³å°æ¥å£æ˜¯å¦æœ‰å˜æ›´
   - æŸ¥çœ‹æ—¥å¿—ç¡®è®¤å…·ä½“å¤±è´¥æ­¥éª¤

3. **ä¼šè¯é¢‘ç¹å¤±æ•ˆ**
   - æ£€æŸ¥æ˜¯å¦æœ‰ IP é™åˆ¶
   - è€ƒè™‘å¢åŠ ä»£ç†æ± 
   - å‡å°‘è¯·æ±‚é¢‘ç‡

4. **CRC æ ¡éªŒé”™è¯¯**
   - ç¡®ä¿æ–‡ä»¶å†…å®¹å®Œæ•´æ€§
   - ä½¿ç”¨ UTF-8 ç¼–ç å¤„ç†ä¸Šä¼ å†…å®¹
   - æ£€æŸ¥ç½‘ç»œä¼ è¾“ç¨³å®šæ€§

5. **æ•°æ®è§£æé”™è¯¯**
   - æ£€æŸ¥ HTML ç»“æ„æ˜¯å¦å˜æ›´
   - æ›´æ–°è§£æè§„åˆ™
   - æ·»åŠ æ›´å¤šå¼‚å¸¸å¤„ç†é€»è¾‘

## 10. ç»“è®º

é€šè¿‡å°†å¾®ä¿¡ç™»å½•æµç¨‹æ¥å…¥ n8n å·¥ä½œæµï¼Œæˆ‘ä»¬å®ç°äº†å¾®ä¿¡å…¬ä¼—å·çˆ¬è™«ç³»ç»Ÿçš„è‡ªåŠ¨åŒ–ç™»å½•ç®¡ç†ï¼Œæœ‰æ•ˆè§£å†³äº†ä¼šè¯è¿‡æœŸé—®é¢˜ï¼Œæé«˜äº†ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚åŒæ—¶ï¼Œé€šè¿‡ n8n çš„å¼ºå¤§åŠŸèƒ½ï¼Œæˆ‘ä»¬è¿˜å®ç°äº†æ•°æ®å¤„ç†ã€å†…å®¹æ¨é€ç­‰å¤šç§è‡ªåŠ¨åŒ–åœºæ™¯ï¼Œå¤§å¤§æå‡äº†ç³»ç»Ÿçš„å®ç”¨æ€§å’Œçµæ´»æ€§ã€‚

æœªæ¥ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä¼˜åŒ–å·¥ä½œæµç¨‹ï¼Œå¢å¼ºç³»ç»ŸåŠŸèƒ½ï¼Œæå‡ç”¨æˆ·ä½“éªŒï¼Œä½¿å¾®ä¿¡å…¬ä¼—å·çˆ¬è™«ç³»ç»Ÿæ›´åŠ æ™ºèƒ½ã€é«˜æ•ˆå’Œå¯é ã€‚